@model IEnumerable<Book>
@{
	ViewData["Title"] = "Book";
}

<div class="container-fluid py-4">
	<div class="row mb-4">
		<div class="col-12">
			<div class="d-flex justify-content-between align-items-center">
				<h2 class="fw-bold text-primary mb-0">
					<i class="bi bi-book me-2"></i>Books Management
				</h2>
				<a asp-action="AddBook" asp-controller="Book" class="btn btn-primary shadow-sm">
					<i class="bi bi-plus-circle me-1"></i> Add New Book
				</a>
			</div>
		</div>
	</div>

	@if (TempData["success"] is not null)
	{
		<div class="alert alert-success alert-dismissible fade show shadow-sm" role="alert">
			<i class="bi bi-check-circle me-2"></i>@TempData["success"]
			<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
		</div>
	}
	@if (TempData["message"] is not null)
	{
		<div class="alert alert-info alert-dismissible fade show shadow-sm" role="alert">
			<i class="bi bi-info-circle me-2"></i>@TempData["message"]
			<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
		</div>
	}
	@if (TempData["error"] is not null)
	{
		<div class="alert alert-danger alert-dismissible fade show shadow-sm" role="alert">
			<i class="bi bi-exclamation-triangle me-2"></i>@TempData["error"]
			<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
		</div>
	}


	<div class="card shadow-sm">
		<div class="card-body p-0">
			@if (Model?.Count() > 0)
			{
				<div class="table-responsive">
					<table class="table table-hover align-middle mb-0">
						<thead class="bg-light">
							<tr>
								<th class="px-4 py-3">Image</th>
								<th class="px-4 py-3">Book</th>
								<th class="px-4 py-3">Author</th>
								<th class="px-4 py-3">Genre</th>
								<th class="px-4 py-3">Price</th>
								<th class="px-4 py-3">Description</th>
								<th class="px-4 py-3 text-center">Actions</th>
							</tr>
						</thead>
						<tbody>
							@foreach (var book in Model)
							{
								<tr>

									<td class="px-4 py-3">
										@if (string.IsNullOrWhiteSpace(book.Image))
										{
											<img src="/Images/NoImage.png" class="img-thumbnail" style="width:80px;height:100px" alt="No book image available" />
										}
										else
										{
											<img src="/Uploads/@book.Image" class="img-thumbnail" style="width:80px;height:100px" alt="@book.BookName cover" />
										}
									</td>
									<td class="px-4 py-3 fw-semibold">
										@(book?.BookName ?? "No Name Available")
									</td>
									<td class="px-4 py-3">@book!.AuthorName</td>
									<td class="px-4 py-3"><span class="badge bg-info text-dark">@book.Genre!.GenreName</span></td>
									<td class="px-4 py-3 fw-bold text-primary">$@book.Price.ToString("0.00")</td>

									<td class="px-4 py-3">
										@(book?.Description?.Length > 25 ? book.Description.Substring(0, 25) + "..." : book?.Description)
									</td>

									<td class="px-4 py-3 text-center">
										<div class="btn-group gap-1" role="group">
											<a asp-action="BookDetails" asp-controller="Book" asp-route-id="@book?.Id" class="btn btn-sm btn-outline-info">
												<i class="bi bi-info-circle me-1"></i>
											</a>
											<a asp-action="UpdateBook" asp-controller="Book" asp-route-id="@book?.Id" class="btn btn-sm btn-outline-primary">
												<i class="bi bi-pencil-square me-1"></i>
											</a>

											<form asp-asp-area="Admin" asp-controller="Book" asp-action="DeleteBook" asp-route-id="@book?.Id">
												<button type="submit" class="btn btn-sm btn-outline-danger"
														onclick="return window.confirm('Are you sure you want to delete this book?')">
													<i class="bi bi-trash me-1"></i>
												</button>
											</form>
										</div>
									</td>
								</tr>
							}
						</tbody>
					</table>
				</div>
			}
			else
			{
				<div class="text-center py-5">
					<i class="bi bi-book-half text-muted" style="font-size: 3rem;"></i>
					<h3 class="mt-3 text-muted">No books available</h3>
					<p class="text-muted">Start by adding your first book to the collection.</p>
				</div>
			}
		</div>
	</div>
</div>